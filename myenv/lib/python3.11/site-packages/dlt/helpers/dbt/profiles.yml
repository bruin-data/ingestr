config:
  # do not track usage, do not create .user.yml
  send_anonymous_usage_stats: False

redshift:
  target: analytics
  outputs:
    analytics:
      type: redshift
      host: "{{ env_var('DLT__CREDENTIALS__HOST') }}"
      user: "{{ env_var('DLT__CREDENTIALS__USERNAME') }}"
      password: "{{ env_var('DLT__CREDENTIALS__PASSWORD') }}"
      port: "{{ env_var('DLT__CREDENTIALS__PORT', 5439) | as_number }}"
      dbname: "{{ env_var('DLT__CREDENTIALS__DATABASE') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      threads: 4
      keepalives_idle: 0 # default 0, indicating the system default
      connect_timeout: "{{ env_var('DLT__CREDENTIALS__CONNECT_TIMEOUT') | as_number}}"
      # search_path: public # optional, not recommended
      #sslmode: [optional, set the sslmode used to connect to the database (in case this parameter is set, will look for ca in ~/.postgresql/root.crt)]
      ra3: true # enables cross-database sources


postgres:
  target: analytics
  outputs:
    analytics:
      type: postgres
      host: "{{ env_var('DLT__CREDENTIALS__HOST') }}"
      user: "{{ env_var('DLT__CREDENTIALS__USERNAME') }}"
      password: "{{ env_var('DLT__CREDENTIALS__PASSWORD') }}"
      port: "{{ env_var('DLT__CREDENTIALS__PORT', 5432) | as_number }}"
      dbname: "{{ env_var('DLT__CREDENTIALS__DATABASE') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      threads: 4
      keepalives_idle: 0 # default 0, indicating the system default
      connect_timeout: "{{ env_var('DLT__CREDENTIALS__CONNECT_TIMEOUT') | as_number}}"
      # search_path: public # optional, not recommended
      #sslmode: [optional, set the sslmode used to connect to the database (in case this parameter is set, will look for ca in ~/.postgresql/root.crt)]
      ra3: true # enables cross-database sources

bigquery_default:
  target: analytics
  outputs:
    analytics:
      type: bigquery
      method: oauth
      project: "{{ env_var('DLT__CREDENTIALS__PROJECT_ID') }}"
      location: "{{ env_var('DLT__LOCATION') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      threads: 4
      keepalives_idle: 0 # default 0, indicating the system default
      job_creation_timeout_seconds: "{{ env_var('DLT__HTTP_TIMEOUT') | as_number}}"
      job_retry_deadline_seconds: "{{ env_var('DLT__RETRY_DEADLINE') | as_number}}"

bigquery:
  target: analytics
  outputs:
    analytics:
      type: bigquery
      method: service-account-json
      project: "{{ env_var('DLT__CREDENTIALS__PROJECT_ID') }}"
      location: "{{ env_var('DLT__LOCATION') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      keyfile_json:
        type: service_account
        project_id: "{{ env_var('DLT__CREDENTIALS__PROJECT_ID') }}"
        private_key: "{{ env_var('DLT__CREDENTIALS__PRIVATE_KEY') }}"
        client_email: "{{ env_var('DLT__CREDENTIALS__CLIENT_EMAIL') }}"
        token_uri: "{{ env_var('DLT__CREDENTIALS__TOKEN_URI') }}"
      threads: 4
      keepalives_idle: 0 # default 0, indicating the system default
      job_creation_timeout_seconds: "{{ env_var('DLT__HTTP_TIMEOUT') | as_number}}"
      job_retry_deadline_seconds: "{{ env_var('DLT__RETRY_DEADLINE') | as_number}}"

duckdb:
  target: analytics
  outputs:
    analytics:
      type: duckdb
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      path: "{{ env_var('DLT__CREDENTIALS__DATABASE') }}"
      extensions:
        - httpfs
        - parquet
      # TODO: emit the config of duck db

motherduck:
  target: analytics
  outputs:
    analytics:
      type: duckdb
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      path: "md:{{ env_var('DLT__CREDENTIALS__DATABASE') }}?token={{env_var('DLT__CREDENTIALS__PASSWORD')}}"

# snowflake with password auth
snowflake:
  target: analytics
  outputs:
    analytics:
      type: snowflake
      account: "{{ env_var('DLT__CREDENTIALS__HOST') }}"
      user: "{{ env_var('DLT__CREDENTIALS__USERNAME') }}"
      password: "{{ env_var('DLT__CREDENTIALS__PASSWORD') }}"
      database: "{{ env_var('DLT__CREDENTIALS__DATABASE') }}"
      role: "{{ env_var('DLT__CREDENTIALS__ROLE', '') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      warehouse: "{{ env_var('DLT__CREDENTIALS__WAREHOUSE', '') }}"
      threads: 4


# snowflake with private key auth
snowflake_pkey:
  target: analytics
  outputs:
    analytics:
      type: snowflake
      account: "{{ env_var('DLT__CREDENTIALS__HOST') }}"
      user: "{{ env_var('DLT__CREDENTIALS__USERNAME') }}"
      database: "{{ env_var('DLT__CREDENTIALS__DATABASE') }}"
      password: "{{ env_var('DLT__CREDENTIALS__PASSWORD') }}"
      role: "{{ env_var('DLT__CREDENTIALS__ROLE', '') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      warehouse: "{{ env_var('DLT__CREDENTIALS__WAREHOUSE', '') }}"
      private_key: "{{ env_var('DLT__CREDENTIALS__PRIVATE_KEY') }}" # base64 encoded private key
      private_key_passphrase: "{{ env_var('DLT__CREDENTIALS__PRIVATE_KEY_PASSPHRASE', '') }}"
      threads: 4


athena:
  target: analytics
  outputs:
    analytics:
      type: athena
      s3_staging_dir: "{{ env_var('DLT__QUERY_RESULT_BUCKET') }}"
      s3_data_dir: "{{ env_var('DLT__BUCKET_URL', env_var('DLT__STAGING_CONFIG__BUCKET_URL')) }}"
      s3_data_naming: schema_table
      aws_access_key_id: "{{ env_var('DLT__CREDENTIALS__AWS_ACCESS_KEY_ID') }}"
      aws_secret_access_key: "{{ env_var('DLT__CREDENTIALS__AWS_SECRET_ACCESS_KEY') }}"
      region_name: "{{ env_var('DLT__CREDENTIALS__REGION_NAME', 'eu-central-1') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      database: "{{ env_var('DLT__AWS_DATA_CATALOG') }}"
      # aws_profile_name: "{{ env_var('DLT__CREDENTIALS__PROFILE_NAME', '') }}"
      work_group: "{{ env_var('DLT__ATHENA_WORK_GROUP', '') }}"


mssql:
  target: analytics
  outputs:
    analytics:
      type: sqlserver
      driver: "{{ env_var('DLT__CREDENTIALS__DRIVER') }}"
      server: "{{ env_var('DLT__CREDENTIALS__HOST') }}"
      port: "{{ env_var('DLT__CREDENTIALS__PORT') | as_number }}"
      database: "{{ env_var('DLT__CREDENTIALS__DATABASE') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      user: "{{ env_var('DLT__CREDENTIALS__USERNAME') }}"
      password: "{{ env_var('DLT__CREDENTIALS__PASSWORD') }}"
      login_timeout: "{{ env_var('DLT__CREDENTIALS__CONNECT_TIMEOUT', '0')  | as_number }}"
      encrypt: "{{ (env_var('DLT__CREDENTIALS__QUERY__ENCRYPT', 'No') == 'yes')  | as_bool }}"
      trust_cert: "{{ (env_var('DLT__CREDENTIALS__QUERY__TRUSTSERVERCERTIFICATE', 'yes') == 'yes')  | as_bool }}"


# commented out because dbt for Synapse isn't currently properly supported.
# Leave config here for potential future use.
# synapse:
#   target: analytics
#   outputs:
#     analytics:
#       type: synapse
#       driver: "{{ env_var('DLT__CREDENTIALS__DRIVER') }}"
#       server: "{{ env_var('DLT__CREDENTIALS__HOST') }}"
#       port: "{{ env_var('DLT__CREDENTIALS__PORT') | as_number }}"
#       database: "{{ env_var('DLT__CREDENTIALS__DATABASE') }}"
#       schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
#       user: "{{ env_var('DLT__CREDENTIALS__USERNAME') }}"
#       password: "{{ env_var('DLT__CREDENTIALS__PASSWORD') }}"


databricks:
  target: analytics
  outputs:
    analytics:
      type: databricks
      catalog: "{{ env_var('DLT__CREDENTIALS__CATALOG') }}"
      schema: "{{ var('destination_dataset_name', var('source_dataset_name')) }}"
      host: "{{ env_var('DLT__CREDENTIALS__SERVER_HOSTNAME') }}"
      http_path: "{{ env_var('DLT__CREDENTIALS__HTTP_PATH') }}"
      token: "{{ env_var('DLT__CREDENTIALS__ACCESS_TOKEN') }}"
      threads: 4


clickhouse:
  target: analytics
  outputs:
    analytics:
      type: clickhouse
      schema: "{{ env_var('DLT__CREDENTIALS__DATABASE') }}"
      host: "{{ env_var('DLT__CREDENTIALS__HOST') }}"
      user: "{{ env_var('DLT__CREDENTIALS__USERNAME') }}"
      password: "{{ env_var('DLT__CREDENTIALS__PASSWORD') }}"
      port: "{{ env_var('DLT__CREDENTIALS__PORT', 8443) | as_number }}"
      secure: True